<!DOCTYPE html>
<html lang="cs">
<head>
<meta charset="UTF-8">
<title>SPF – Síťový provozní fond · WIN.WIN</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
:root{
  --bg:#020617;
  --card:#0b1120;
  --border:rgba(148,163,184,.25);
  --text:#e5e7eb;
  --muted:#9ca3af;
  --gold:#facc15;
  --green:#22c55e;
  --red:#ef4444;
}

*{box-sizing:border-box;margin:0;padding:0}
body{
  background:radial-gradient(circle at 40% 0%, #0f172a 0%, #020617 65%, #000 100%);
  font-family:"Segoe UI",Tahoma,Verdana,sans-serif;
  color:var(--text);
}

.page{max-width:1400px;margin:auto;padding:42px 18px 80px}

.card{
  background:radial-gradient(circle at top left,#0b1120,#020617 70%);
  border:1px solid var(--border);
  border-radius:20px;
  padding:22px;
  margin-bottom:26px;
}

.kicker{
  display:flex;
  align-items:center;
  gap:10px;
  font-size:12px;
  letter-spacing:.14em;
  text-transform:uppercase;
  color:var(--muted);
  margin-bottom:6px;
}

.dot{
  width:9px;height:9px;border-radius:999px;
  background:var(--gold);
  box-shadow:
    0 0 6px var(--gold),
    0 0 16px var(--gold),
    0 0 36px rgba(250,204,21,.9);
}

h1{font-size:30px;margin-bottom:10px}
h2{font-size:18px;margin-bottom:10px}
p{font-size:13px;line-height:1.6;color:var(--muted)}

table{width:100%;border-collapse:collapse;font-size:12px}
th,td{padding:10px;border-bottom:1px solid var(--border)}
th{color:var(--muted)}

.actions{display:flex;gap:8px}
button{
  padding:6px 12px;
  border-radius:10px;
  font-size:11px;
  cursor:pointer;
  background:#020617;
  border:1px solid var(--border);
  color:var(--text);
}
.approve{border-color:var(--green);color:var(--green)}
.reject{border-color:var(--red);color:var(--red)}

.dot-gold{
  background:#facc15;
  box-shadow:
    0 0 6px rgba(250,204,21,.9),
    0 0 14px rgba(250,204,21,.8),
    0 0 30px rgba(250,204,21,.6);
}

</style>
</head>

<body>


<div class="page">
<div class="card">
  <div class="kicker">
    <span class="dot"></span>
    Interní rozhodovací vrstva
  </div>
  <h1>SPF – Síťový provozní fond družstva WIN.WIN</h1>
  <p>
    Tato stránka slouží k <b>internímu vyhodnocení, schvalování a zamítání</b>
    přídělů do SPF a matching bonusů. Nejedná se o veřejnou prezentaci
    ani nárokový systém.
  </p>
</div>
<div class="card">
  <h2>Stav SPF za období</h2>

  <table>
    <thead>
      <tr>
        <th>Období</th>
        <th>Celkový příděl CRX</th>
        <th>Návrh do SPF</th>
        <th>Stav</th>
        <th>Akce</th>
      </tr>
    </thead>
    <tbody id="spf-periods">
      <!-- DB -->
    </tbody>
  </table>
</div>
<div class="card">
  <p>
    SPF je interní nenárokový mechanismus družstva.
    Přidělení prostředků podléhá výhradně rozhodnutí
    orgánů družstva a nepředstavuje investici,
    výnos ani garantované plnění.
  </p>
</div>
<div class="card">
  <div class="actions" style="align-items:center;">
    <span class="dot"></span>

    <button onclick="pdfSPF()">
      PDF – rozhodnutí SPF (interní)
    </button>
  </div>

  <p class="muted" style="margin-top:8px;">
    Generuje interní PDF přehled stavu SPF za zvolené období.
    Dokument slouží výhradně pro evidenci a audit družstva.
  </p>
</div>

</div>
<script type="module">
import { createClient } from
  "https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm";

const supabase = createClient(
   "https://azfrniqqtetoqploxwgq.supabase.co",
  "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImF6ZnJuaXFxdGV0b3FwbG94d2dxIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njc3MzQ1OTYsImV4cCI6MjA4MzMxMDU5Nn0.QchmzNhs8owd6pkjZCk04u6PJoJ2Bhzz7oGV0KFyqdU"
);

async function loadSPF() {
  const { data, error } = await supabase
    .from("spf_periods")
    .select("*")
    .order("period", { ascending: false });

  const tbody = document.getElementById("spf-periods");
  tbody.innerHTML = "";

  if (error) {
    tbody.innerHTML =
      `<tr><td colspan="5">Chyba načtení SPF</td></tr>`;
    return;
  }

  if (!data || !data.length) {
    tbody.innerHTML =
      `<tr><td colspan="5">Zatím žádná SPF období</td></tr>`;
    return;
  }

  data.forEach(r => {
    tbody.innerHTML += `
      <tr>
        <td>${r.period}</td>
        <td>${r.total_crx}</td>
        <td>${r.spf_proposal}</td>
        <td>${r.status}</td>
        <td>—</td>
      </tr>
    `;
  });
}

loadSPF();
</script>

<script>
/* =========================================================
   PDF – ROZDĚLENÍ BENEFITŮ (STEJNÁ LOGIKA)
   ========================================================= */
function pdfSPF(){
  const table = document.getElementById("spf-periods");

  if (!table) {
    alert("Tabulka SPF nebyla nalezena.");
    return;
  }

  const tableHtml = table.closest("table").outerHTML;

  openPdfWindow(
    "AYAS-7 · Síťový provozní fond (SPF)",
    tableHtml
  );
}
</script>


</body>
</html>
