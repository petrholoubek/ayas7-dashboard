<!doctype html>
<html lang="cs">
<head>
<meta charset="utf-8"/>
<title>AYAS-7 · Truth Snapshot</title>
<meta name="viewport" content="width=device-width, initial-scale=1"/>


<!-- PWA -->
<link rel="manifest" href="/manifest.json">

<link rel="icon" sizes="192x192" href="/ayas7-192.png">
<link rel="icon" sizes="512x512" href="/ayas7-512.png">
<link rel="apple-touch-icon" href="/ayas7-192.png">


<meta name="theme-color" content="#020617">

<style>
/* =========================================================
   AYAS-7 • TRUTH SNAPSHOT
   READ ONLY • FINTECH • CALM
========================================================= */

:root{
  --bg:#020617;
  --panel:#0f172acc;
  --border:#94a3b833;

  --blue:#38bdf8;
  --green:#22c55e;
  --yellow:#facc15;
  --purple:#a855f7;

  --text:#e5e7eb;
  --muted:#9ca3af;
}

html,body{
  margin:0;
  padding:0;
  min-height:100%;
  background:
    radial-gradient(circle at 30% -10%, #0f172a 0%, transparent 45%),
    radial-gradient(circle at 80% 20%, #02081a 0%, transparent 50%),
    radial-gradient(circle at 50% 120%, #020617 0%, #000 65%);
  background-attachment:fixed;
  font-family:"Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
  color:var(--text);
}

main{
  max-width:1200px;
  margin:48px auto 140px;
  padding:0 18px;
}

/* HERO */
.hero{margin-bottom:42px}
.hero-kicker{
  display:flex;align-items:center;gap:8px;
  font-size:11px;letter-spacing:.18em;
  text-transform:uppercase;color:var(--muted)
}
.hero-dot{
  width:8px;height:8px;border-radius:50%;
  background:var(--blue);box-shadow:0 0 10px var(--blue)
}
.hero-title{margin-top:12px;font-size:32px;font-weight:800}
.hero-sub{
  margin-top:8px;max-width:880px;
  font-size:14px;line-height:1.6;color:#9ca3b5
}

/* LAYOUT */
.section{margin-top:40px}
.section-label{
  font-size:11px;letter-spacing:.18em;
  text-transform:uppercase;color:var(--muted);
  margin-bottom:12px
}
.card{
  background:linear-gradient(180deg,rgba(15,23,42,.9),rgba(2,6,23,.96));
  border:1px solid var(--border);
  border-radius:18px;
  padding:18px 20px 22px
}
.grid{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:22px
}
@media(max-width:900px){.grid{grid-template-columns:1fr}}

.metric{
  display:flex;justify-content:space-between;
  font-size:13px;margin-bottom:6px
}
.metric span:first-child{color:#9ca3af}
.value{font-weight:800;font-variant-numeric:tabular-nums}

/* GRAPH */
.graph{
  height:300px;border-radius:14px;
  background:#020617;
  border:1px solid rgba(255,255,255,.06);
  overflow:hidden
}
canvas{width:100%;height:100%;display:block}

/* FOOTER */
footer{
  margin-top:72px;padding-top:14px;
  border-top:1px solid var(--border);
  font-size:11px;letter-spacing:.16em;
  text-transform:uppercase;color:#64748b
}
/* =========================
   SYSTEM HEALTH BAR
========================= */

.health-bar-wrap{
  padding:28px 24px 30px;
}

.health-bar-label{
  display:flex;
  justify-content:space-between;
  margin-bottom:12px;
  font-size:13px;
  letter-spacing:.12em;
  text-transform:uppercase;
  color:#9ca3af;
}

.health-bar-label span:last-child{
  font-weight:800;
  color:#e5e7eb;
  letter-spacing:normal;
}

.health-bar-bg{
  width:100%;
  height:14px;
  background:rgba(255,255,255,.06);
  border-radius:10px;
  overflow:hidden;
}

.health-bar-fill{
  height:100%;
  width:0%;
  border-radius:10px;
  transition:width 1.2s ease;
  background:linear-gradient(
    90deg,
    #22c55e,
    #38bdf8
  );
  box-shadow:0 0 12px rgba(56,189,248,.45);
}
.section-live{
  display:flex;
  align-items:center;
  gap:8px;
}

.led-dot{
  width:6px;
  height:6px;
  border-radius:50%;
  background:#ef4444; /* offline default */
  box-shadow:0 0 6px rgba(239,68,68,.6);
  transition:background .3s ease, box-shadow .3s ease;
}

.led-dot.live{
  background:#22c55e;
  box-shadow:0 0 6px rgba(34,197,94,.8);
}
/* =========================
   TOKEN ROW – SIDE BY SIDE
========================= */

.token-row{
  display:grid;
  grid-template-columns:repeat(3,1fr);
  gap:22px;
}

/* Na menších mobilech se to zlomí – přirozeně */
@media(max-width:760px){
  .token-row{
    grid-template-columns:1fr;
  }
}

.token-box{
  position:relative;
  padding:22px 22px 26px;
  border-radius:20px;
  background:linear-gradient(180deg,rgba(15,23,42,.95),rgba(2,6,23,.98));
  border:1px solid var(--border);
  overflow:hidden;
}

.token-box::before{
  content:"";
  position:absolute;
  inset:0;
  opacity:.12;
  pointer-events:none;
}

/* HEAD */
.token-head h3{
  margin:0;
  font-size:15px;
  letter-spacing:.1em;
}
.token-head span{
  display:block;
  margin-top:4px;
  font-size:11px;
  letter-spacing:.14em;
  text-transform:uppercase;
  color:var(--muted);
}

/* VALUE */
.token-value{
  margin:18px 0 16px;
  font-size:32px;
  font-weight:900;
  font-variant-numeric:tabular-nums;
}
.token-value.internal{
  font-size:20px;
  letter-spacing:.2em;
  color:#c084fc;
}

/* META */
.token-meta{
  display:flex;
  justify-content:space-between;
  font-size:13px;
  margin-top:6px;
}

/* FOOT */
.token-foot{
  margin-top:14px;
  font-size:11px;
  letter-spacing:.16em;
  text-transform:uppercase;
  color:var(--muted);
}
.token-foot.prestige{
  color:#d8b4fe;
  font-weight:600;
}

/* COLOR IDENTITY */
.token-box.unit{
  border-top:3px solid var(--blue);
}
.token-box.unit::before{
  background:radial-gradient(circle at 20% 0%, var(--blue), transparent 60%);
}

.token-box.reserve{
  border-top:3px solid var(--yellow);
}
.token-box.reserve::before{
  background:radial-gradient(circle at 20% 0%, var(--yellow), transparent 60%);
}

.token-box.key{
  border-top:3px solid var(--purple);
}
.token-box.key::before{
  background:radial-gradient(circle at 20% 0%, var(--purple), transparent 60%);
}
.trust-panel{
  display:flex;
  flex-direction:column;
  gap:10px;
}

.trust-row{
  display:flex;
  justify-content:space-between;
  font-size:13px;
  padding:6px 0;
  border-bottom:1px dashed rgba(255,255,255,.06);
}

.trust{
  font-weight:700;
  letter-spacing:.08em;
}

.trust.ok{
  color:#22c55e;
}
/* =========================
   SYSTEM TRACE PANEL
========================= */

.trace-panel{
  display:flex;
  flex-direction:column;
  gap:14px;
}

/* FLOW */
.trace-flow{
  height:90px;
  border-radius:12px;
  background:linear-gradient(
    180deg,
    rgba(56,189,248,.08),
    rgba(2,6,23,.95)
  );
  position:relative;
  overflow:hidden;
}

.trace-line{
  position:absolute;
  inset:0;
  background:linear-gradient(
    120deg,
    transparent 30%,
    rgba(56,189,248,.35),
    transparent 70%
  );
  animation:traceFlow 6s linear infinite;
}

@keyframes traceFlow{
  from{transform:translateX(-100%)}
  to{transform:translateX(100%)}
}

/* TIMELINE */
.trace-log{
  font-size:12px;
  line-height:1.7;
  color:#9ca3af;
}

.trace-note{
  font-size:11px;
  letter-spacing:.14em;
  text-transform:uppercase;
  color:#64748b;
}
/* OFFLINE MODE – TRACE */
body.offline .trace-line{
  animation:none;
  opacity:.3;
}

body.offline .trace-note::after{
  content:" · waiting for snapshot";
  color:#64748b;
}


</style>
</head>

<body>

<main>

<!-- HERO -->
<section class="hero">
  <div class="hero-kicker">
    <span class="hero-dot"></span>
    Truth Snapshot · Read Only
  </div>
  <div class="hero-title">AYAS-7 · Stav systému</div>
  <div class="hero-sub">
    Klidný, neměnný pohled na skutečný stav architektury AYAS-7.
    Tato obrazovka nic neřídí – pouze zobrazuje pravdu systému.
  </div>
</section>

<!-- TOKEN COCKPIT -->
<section class="section">
  <div class="section-label">Tokens · Core Layers</div>

  <div class="token-row">

    <!-- WW-UNIT -->
    <div class="token-box unit">
      <div class="token-head">
        <h3>WW-UNIT</h3>
        <span>Operational</span>
      </div>

      <div class="token-value" id="unitPrice">$1.14</div>

      <div class="token-meta">
        <span>Deploy</span>
        <span id="unitSupply" class="value">—</span>
      </div>

      <div class="token-foot">DEX · Pool Active</div>
    </div>

    <!-- WW-RESERVE -->
    <div class="token-box reserve">
      <div class="token-head">
        <h3>WW-RESERVE</h3>
        <span>Stability</span>
      </div>

      <div class="token-value" id="reservePrice">$0.99</div>

      <div class="token-meta">
        <span>Backing</span>
        <span id="reserveBacking" class="value">—</span>
      </div>

      <div class="token-foot">DEX · Backed</div>
    </div>

    <!-- WW-KEY -->
    <div class="token-box key">
      <div class="token-head">
        <h3>WW-KEY</h3>
        <span>Internal</span>
      </div>

      <div class="token-value internal">INTERNAL</div>

      <div class="token-meta">
        <span>Issued</span>
        <span id="keyIssued" class="value">—</span>
      </div>

      <div class="token-meta">
        <span>Holders</span>
        <span id="keyHolders" class="value">—</span>
      </div>

      <div class="token-foot prestige">FOUNDING CIRCLE</div>
    </div>

  </div>
</section>


<!-- SYSTEM -->
<section class="section">
  <div class="section-label">System</div>
  <div class="card">
    <div class="metric"><span>Mode</span><span id="sysMode" class="value">—</span></div>
    <div class="metric"><span>Health</span><span id="sysHealth" class="value">—</span></div>
    <div class="metric"><span>Uptime</span><span id="sysUptime" class="value">—</span></div>
    <div class="metric"><span>Snapshot</span><span id="snapTime" class="value">—</span></div>
  </div>
</section>

<section class="section grid">

  <!-- LEFT: SYSTEM TRACE -->
  <div class="card trace-panel">
    <div class="section-label">System Trace</div>

    <div class="trace-flow">
      <div class="trace-line"></div>
    </div>

    <div class="trace-log">
      <div>• Snapshot generated</div>
      <div>• Pool verified</div>
      <div>• Reserve checked</div>
      <div>• Snapshot generated</div>
    </div>

    <div class="trace-note">Snapshot-based system activity</div>
  </div>

  <!-- RIGHT: SYSTEM LINKS -->
  <div class="card trust-panel">
  <div class="section-label">System Links</div>

  <div class="trust-row">
    <span>Snapshot Writer</span>
    <span class="trust ok">RUNNING</span>
  </div>

  <div class="trust-row">
    <span>Snapshot API</span>
    <span class="trust ok">LIVE</span>
  </div>

  <div class="trust-row">
    <span>Cloud Tunnel</span>
    <span class="trust ok">CONNECTED</span>
  </div>

  <div class="trust-row">
    <span>DEX</span>
    <span class="trust ok">AVAILABLE</span>
  </div>

  <div class="trust-row">
    <span>Liquidity Pool</span>
    <span class="trust ok">ACTIVE</span>
  </div>
</div>


</section>

<!-- OPERATIONAL STATUS -->
<section class="section">
  <div class="section-label section-live">
    <span class="led-dot" id="sectionLed"></span>
    Operational Status · Snapshot
  </div>

  <div class="card">
    <div class="health-bar-wrap">
      <div class="health-bar-label">
        <span>Operational Status</span>
        <span>
  <span id="healthValue">—</span>
  <span id="healthState" style="margin-left:8px;color:#9ca3af;font-weight:600"></span>
</span>

      </div>

      <div class="health-bar-bg">
        <div class="health-bar-fill" id="healthBar"></div>
      </div>
    </div>
  </div>
</section>
<p style="
  margin-top:32px;
  font-size:11px;
  letter-spacing:.14em;
  text-transform:uppercase;
  color:#64748b
">
Read-only operational view · No execution · No custody
</p>


<footer>
  AYAS-7 · Truth Snapshot · Read Only
</footer>

</main>
<script>
(async function () {

 const SNAPSHOT_URL = "https://snapshot.ayas7.com/api/snapshot";
 const CACHE_KEY = "AYAS_SNAPSHOT_CACHE";

  
function updateHealthBar(v){
  if(v == null || isNaN(v)) return;

  const val = Math.max(0, Math.min(100, Number(v)));
  const bar = document.getElementById("healthBar");
  const txt = document.getElementById("healthValue");

  if(!bar || !txt) return;

  bar.style.width = val + "%";
  txt.textContent = val.toFixed(1) + " %";

  // barva podle stavu
  if(val >= 70){
    bar.style.background = "linear-gradient(90deg,#22c55e,#4ade80)";
    bar.style.boxShadow = "0 0 14px rgba(34,197,94,.45)";
  }else if(val >= 40){
    bar.style.background = "linear-gradient(90deg,#facc15,#fde047)";
    bar.style.boxShadow = "0 0 14px rgba(250,204,21,.35)";
  }else{
    bar.style.background = "linear-gradient(90deg,#ef4444,#f87171)";
    bar.style.boxShadow = "0 0 14px rgba(239,68,68,.45)";
  }
}

async function loadSnapshot() {
  try {
    const res = await fetch(SNAPSHOT_URL, { cache: "no-store" });
    if (!res.ok) throw new Error("API error");

    const data = await res.json();

    // ❌ cache ÚPLNĚ pryč – žádná localStorage pravda
    render(data);
    updateNet(true);

  } catch (err) {
    // ❌ žádný fallback na stará data
    renderError();
    updateNet(false);
  }
}

  function render(s) {
console.log("WW_RESERVE RAW →", s.tokens.WW_RESERVE);



  /* SYSTEM */
  set("sysMode", s.meta?.mode ?? "—");
  set("sysHealth", formatPct(s.meta?.health));
  updateHealthBar(s.meta?.health);
  set("healthState", healthStateLabel(s.meta?.health, true));
  set("sysUptime", s.meta?.uptime ?? "—");
  set("snapTime", formatTime(s.meta?.generatedAt));

  /* LIQUIDITY */
  set("liqTVL", formatUSD(s.pools?.liquidityUSD));
  set("liqUtil", formatPct(s.pools?.utilization));
  set("liqDepth", s.pools?.depth ?? "—");
  set("liqSlip", formatPct(s.pools?.slippage));

/* ===============================
   TOKENS — SNAPSHOT v2.0 (SSOT)
=============================== */

set(
  "unitSupply",
  formatNum(s.tokens?.WW_UNIT?.supply)
);

set(
  "reservePrice",
  s.tokens?.WW_RESERVE?.priceUSD != null
    ? "$" + Number(s.tokens.WW_RESERVE.priceUSD).toFixed(6)
    : "—"
);

set(
  "reserveBacking",
  s.tokens?.WW_RESERVE?.marketCapUSD != null
    ? formatUSD(s.tokens.WW_RESERVE.marketCapUSD)
    : "—"
);

set(
  "keyIssued",
  formatNum(s.tokens?.WW_KEY?.issued)
);

set(
  "keyHolders",
  formatNum(s.tokens?.WW_KEY?.holders)
);



}


  function renderError() {
    set("healthState", "OFFLINE");

    set("sysMode", "offline");
    set("sysHealth", "—");
    set("snapTime", "—");
  }
function healthStateLabel(v, online){
  if(!online) return "OFFLINE";
  if(v >= 75) return "STABLE";
  if(v >= 40) return "ACTIVE";
  return "LIMITED";
}


  /* ===== HELPERS ===== */

  function set(id, val) {
    const el = document.getElementById(id);
    if (el) el.textContent = val ?? "—";
  }

  function formatUSD(v) {
    if (v == null) return "—";
    return "$" + Number(v).toLocaleString("en-US", { maximumFractionDigits: 2 });
  }

  function formatNum(v) {
    if (v == null) return "—";
    return Number(v).toLocaleString("en-US");
  }

  function formatPct(v) {
    if (v == null) return "—";
    return Number(v).toFixed(2) + " %";
  }
function snapshotAge(ts){
  if(!ts) return "—";

  const diff = Math.floor((Date.now() - new Date(ts).getTime()) / 1000);

  if(diff < 60) return diff + " s ago";
  if(diff < 3600) return Math.floor(diff/60) + " min ago";
  return Math.floor(diff/3600) + " h ago";
}


  // ✅ SPRÁVNÝ ČAS – STEJNÝ NA PC I iPHONU
  function formatTime(t) {
    if (!t) return "—";
    return new Date(t).toLocaleString("cs-CZ", {
      year: "numeric",
      month: "2-digit",
      day: "2-digit",
      hour: "2-digit",
      minute: "2-digit",
      second: "2-digit"
    });
  }

  
function updateNet(online) {
  const heroDot = document.querySelector(".hero-dot");
  const sectionDot = document.getElementById("sectionLed");

  if (heroDot) {
    heroDot.style.background = online ? "#22c55e" : "#ef4444";
    heroDot.style.boxShadow = online
      ? "0 0 10px #22c55e"
      : "0 0 10px #ef4444";
  }

  if (sectionDot) {
    sectionDot.classList.toggle("live", online);
  }
document.body.classList.toggle("offline", !online);
}


  loadSnapshot();
  setInterval(loadSnapshot, 30000); // klidný refresh

})();
</script>

</body>
</html>
