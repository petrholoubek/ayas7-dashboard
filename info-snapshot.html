<!doctype html>
<html lang="cs">
<head>
<meta charset="utf-8"/>
<title>AYAS-7 · Truth Snapshot</title>
<meta name="viewport" content="width=device-width, initial-scale=1"/>

<!-- PWA -->
<link rel="manifest" href="/manifest.json">
<link rel="icon" sizes="192x192" href="/ayas7-192.png">
<link rel="icon" sizes="512x512" href="/ayas7-512.png">
<link rel="apple-touch-icon" href="/ayas7-192.png">
<meta name="theme-color" content="#020617">

<style>
/* ===============================
   AYAS-7 • SYSTEM ENGINE APP
================================ */

:root{
  --bg:#020617;
  --border:#94a3b833;
  --blue:#38bdf8;
  --green:#22c55e;
  --red:#ef4444;
  --text:#e5e7eb;
  --muted:#9ca3af;
}

/* BASE */
html,body{
  margin:0;
  padding:0;
  min-height:100%;
  background:
    radial-gradient(circle at 30% -10%, #0f172a 0%, transparent 45%),
    radial-gradient(circle at 80% 20%, #02081a 0%, transparent 50%),
    radial-gradient(circle at 50% 120%, #020617 0%, #000 65%);
  font-family:"Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
  color:var(--text);
}

/* HERO = SYSTEM SPACE */
.ayas-hero{
  position:relative;
  height:60vh;
  min-height:460px;
  overflow:hidden;
}
.ayas-hero img{
  width:100%;
  height:100%;
  object-fit:cover;
  display:block;
}
.ayas-hero::after{
  content:"";
  position:absolute;
  inset:auto 0 0 0;
  height:200px;
  background:linear-gradient(to bottom, rgba(2,6,23,0), #020617);
}

/* MAIN FLOW (NO PAGE BREAK) */
main{
  max-width:1200px;
  margin:-180px auto 160px; /* klíčové napojení */
  padding:0 18px;
  position:relative;
  z-index:3;
}

/* SYSTEM SEGMENTS */
.ayas-box{
  background:linear-gradient(180deg, rgba(15,23,42,.90), rgba(2,6,23,.97));
  border:1px solid rgba(148,163,184,.22);
  border-radius:22px;
  padding:24px 26px 28px;
  margin-bottom:28px;
}

/* CORE BOX – první systémová vrstva */
.ayas-box.core{
  box-shadow:
    0 0 0 1px rgba(56,189,248,.25),
    0 40px 120px rgba(2,6,23,.95);
}

/* TITLES + LED */
.ayas-box-title{
  display:flex;
  align-items:center;
  gap:10px;
  font-size:12px;
  letter-spacing:.18em;
  text-transform:uppercase;
  color:var(--muted);
  margin-bottom:16px;
}

/* LED */
.led-dot{
  width:9px;
  height:9px;
  border-radius:50%;
  background:var(--red);
  box-shadow:0 0 8px rgba(239,68,68,.8);
  transition:background .35s ease, box-shadow .35s ease;
}
.led-dot.live{
  background:var(--green);
  box-shadow:0 0 10px rgba(34,197,94,.95);
}

/* GRID */
.grid{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:22px;
}
@media(max-width:900px){
  .grid{grid-template-columns:1fr;}
}

/* METRICS */
.metric{
  display:flex;
  justify-content:space-between;
  font-size:13px;
  margin-bottom:6px;
}
.metric span:first-child{color:var(--muted)}
.value{font-weight:800;font-variant-numeric:tabular-nums}

/* HEALTH BAR */
.health-bar-wrap{padding-top:6px}
.health-bar-label{
  display:flex;
  justify-content:space-between;
  margin-bottom:12px;
  font-size:12px;
  letter-spacing:.12em;
  text-transform:uppercase;
  color:var(--muted);
}
.health-state{
  margin-left:6px;
  font-size:11px;
  letter-spacing:.12em;
  color:var(--muted);
}
.health-bar-bg{
  width:100%;
  height:14px;
  background:rgba(255,255,255,.06);
  border-radius:10px;
  overflow:hidden;
}
.health-bar-fill{
  height:100%;
  width:0%;
  border-radius:10px;
  transition:width 1.2s ease;
}

/* FOOTER */
footer{
  margin-top:64px;
  padding-top:14px;
  border-top:1px solid var(--border);
  font-size:11px;
  letter-spacing:.16em;
  text-transform:uppercase;
  color:#64748b;
  text-align:center;
}
</style>
</head>

<body>

<header class="ayas-hero">
  <img src="/ayas7-hero.jpg" alt="AYAS-7 System Engine">
</header>

<main>

<!-- SYSTEM CORE -->
<section class="ayas-box core">
  <div class="ayas-box-title">
    <span class="led-dot"></span>
    System · Truth Snapshot
  </div>
  <div class="metric"><span>Mode</span><span id="sysMode" class="value">—</span></div>
  <div class="metric"><span>Health</span><span id="sysHealth" class="value">—</span></div>
  <div class="metric"><span>Uptime</span><span id="sysUptime" class="value">—</span></div>
  <div class="metric"><span>Snapshot</span><span id="snapTime" class="value">—</span></div>
</section>

<!-- OPERATIONAL STATUS -->
<section class="ayas-box">
  <div class="ayas-box-title">
    <span class="led-dot"></span>
    Operational Status
  </div>

  <div class="health-bar-wrap">
    <div class="health-bar-label">
      <span>Status</span>
      <span>
        <span id="healthValue">—</span>
        <span id="healthState" class="health-state"></span>
      </span>
    </div>
    <div class="health-bar-bg">
      <div class="health-bar-fill" id="healthBar"></div>
    </div>
  </div>
</section>

<!-- LIQUIDITY + TOKENS -->
<div class="grid">
  <section class="ayas-box">
    <div class="ayas-box-title">Liquidity</div>
    <div class="metric"><span>TVL</span><span id="liqTVL" class="value">—</span></div>
    <div class="metric"><span>Utilization</span><span id="liqUtil" class="value">—</span></div>
    <div class="metric"><span>Depth</span><span id="liqDepth" class="value">—</span></div>
    <div class="metric"><span>Slippage</span><span id="liqSlip" class="value">—</span></div>
  </section>

  <section class="ayas-box">
    <div class="ayas-box-title">Tokens</div>
    <div class="metric"><span>WW-UNIT</span><span id="unitSupply" class="value">—</span></div>
    <div class="metric"><span>WW-RESERVE</span><span id="reserveSupply" class="value">—</span></div>
    <div class="metric"><span>WW-KEY</span><span id="keySupply" class="value">—</span></div>
  </section>
</div>

<!-- AUDIT -->
<section class="ayas-box">
  <div class="ayas-box-title">Audit & Certification</div>
  <ul style="padding-left:18px;color:#9ca3af">
    <li>System Integrity Verification</li>
    <li>Liquidity & Accounting Audit</li>
    <li>Multisig & Governance Validation</li>
  </ul>
</section>

<footer>
  AYAS-7 · Truth Snapshot · Read Only
</footer>

</main>

<script>
(async function(){

const SNAPSHOT_URL="https://snapshot.ayas7.com/api/snapshot";
const CACHE_KEY="AYAS_SNAPSHOT_CACHE";

function updateNet(online){
  document.querySelectorAll('.led-dot')
    .forEach(d=>d.classList.toggle('live',online));
}

function updateHealthBar(v){
  if(v==null||isNaN(v))return;
  const val=Math.max(0,Math.min(100,Number(v)));
  const bar=document.getElementById("healthBar");
  const txt=document.getElementById("healthValue");
  bar.style.width=val+"%";
  txt.textContent=val.toFixed(1)+" %";

  if(val>=70) bar.style.background="linear-gradient(90deg,#22c55e,#4ade80)";
  else if(val>=40) bar.style.background="linear-gradient(90deg,#facc15,#fde047)";
  else bar.style.background="linear-gradient(90deg,#ef4444,#f87171)";
}

function healthStateLabel(v){
  if(v>=75)return"STABLE";
  if(v>=40)return"ACTIVE";
  return"LIMITED";
}

async function loadSnapshot(){
  try{
    const r=await fetch(SNAPSHOT_URL,{cache:"no-store"});
    if(!r.ok)throw 0;
    const d=await r.json();
    localStorage.setItem(CACHE_KEY,JSON.stringify(d));
    render(d);updateNet(true);
  }catch{
    const c=localStorage.getItem(CACHE_KEY);
    if(c)render(JSON.parse(c));
    updateNet(false);
  }
}

function render(s){
  set("sysMode",s.meta?.mode);
  set("sysHealth",s.meta?.health?.toFixed(2)+" %");
  updateHealthBar(s.meta?.health);
  set("healthState",healthStateLabel(s.meta?.health));
  set("sysUptime",s.meta?.uptime);
  set("snapTime",fmtTime(s.meta?.generatedAt));
  set("liqTVL",fmtUSD(s.pools?.liquidityUSD));
  set("liqUtil",fmtPct(s.pools?.utilization));
  set("liqDepth",s.pools?.depth);
  set("liqSlip",fmtPct(s.pools?.slippage));
  set("unitSupply",fmtNum(s.tokens?.WW_UNIT?.supply));
  set("reserveSupply",fmtUSD(s.tokens?.WW_RESERVE?.balance));
  set("keySupply",fmtNum(s.tokens?.WW_KEY?.holders));
}

function set(id,v){const e=document.getElementById(id);if(e)e.textContent=v??"—";}
const fmtUSD=v=>v==null?"—":"$"+Number(v).toLocaleString("en-US",{maximumFractionDigits:2});
const fmtNum=v=>v==null?"—":Number(v).toLocaleString("en-US");
const fmtPct=v=>v==null?"—":Number(v).toFixed(2)+" %";
const fmtTime=t=>t?new Date(t).toLocaleString("cs-CZ"):"—";

loadSnapshot();
setInterval(loadSnapshot,30000);

})();
</script>

</body>
</html>
